#filter(is.na(Child_Word_phon) | Phon_dist =="0") %>%
distinct(Experimenter_Word))$Experimenter_Word
sem_plot <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(CosSim),
sd = sd(CosSim),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
sem_plot$Age2 = factor(sem_plot$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(sem_plot, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
ggplot(subset(phon_sem_dist, Phon_dist < 7), aes(x=Phon_dist, y=CosSim))+
#ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
geom_smooth(method = "lm")+
#geom_smooth()+
facet_grid(. ~ Age2)
ggplot(subset(phon_sem_dist, Phon_dist < 4), aes(x=Phon_dist, y=CosSim))+
#ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
geom_smooth(method = "lm")+
#geom_smooth()+
facet_grid(. ~ Age2)
ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
#ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
geom_smooth(method = "lm")+
#geom_smooth()+
facet_grid(. ~ Age2)
ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
geom_smooth(method = "lm")+
#geom_smooth()+
facet_grid(. ~ Age2)
word_excl <- (d_assoc_all %>%
filter(is.na(CosSim) | Phon_dist =="0") %>%
#filter(is.na(Child_Word_phon) | Phon_dist =="0") %>%
distinct(Experimenter_Word))$Experimenter_Word
sem_all <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(CosSim),
sd = sd(CosSim),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
sem_all$Age2 = factor(sem_all$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(sem_all, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
##Break by part of speach
head(d_assoc_all)
sem_pos <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2, partofspeech) %>%
summarise(mean = mean(CosSim),
sd = sd(CosSim),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
sem_pos$Age2 = factor(sem_pos$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(sem_pos, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))+
facet_grid. ~ partofspeech)
ggplot(sem_pos, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))+
facet_grid(. ~ partofspeech)
head(d)
#For each word, list all other the words that have been mentioned
#I should calculate the most frequent response and the percentage from
dict <- read_delim("data/cmu_dict.txt", delim = ",")
d_assoc <- d %>%
dplyr::group_by(Experimenter_Word, partofspeech, ResponseType,  Age2, Child_Word) %>%
dplyr::summarise(n=n()) %>%
dplyr::mutate(percent = 100*n/sum(n)) %>%
dplyr::filter(percent == max(percent))
Exp_words <- d_assoc %>%
ungroup() %>%
select(Experimenter_Word) %>%
distinct() %>%
mutate(Word = toupper(Experimenter_Word)) %>%
left_join(dict) %>%
select(-Word) %>%
rename(Experimenter_Word_phon = Phonetic)
Chi_words <- d_assoc %>%
ungroup() %>%
select(Child_Word) %>%
distinct() %>%
mutate(Word = toupper(Child_Word)) %>%
left_join(dict) %>%
select(-Word) %>%
rename(Child_Word_phon = Phonetic)
d_assoc_phon <- d_assoc %>%
left_join(Exp_words) %>%
left_join(Chi_words) %>%
rowwise() %>%
mutate(
Exp_code = convert(Experimenter_Word_phon, phon_dict),
Child_code = convert(Child_Word_phon, phon_dict)
) %>%
mutate(Phon_dist = adist(Exp_code, Child_code))
#Generate the model and store it in "derived"
##Uncomment the following code to re-run the Word2Vec model
#model = train_word2vec("data/corpus.txt",
#                            output="corpus.bin", threads = 4,
#                             vectors = 100, window=20, cbow=1, min_count = 10, force= TRUE)
#Read the model
model = read.vectors("derived/corpus.bin")
Child_words <- (d %>%
distinct(Child_Word))$Child_Word
Experimenter_words <- (d %>%
distinct(Experimenter_Word))$Experimenter_Word
model_cue <- model[[which(rownames(model) %in% Experimenter_words), average=FALSE]]
model_target <- model[[which(rownames(model) %in% Child_words), average=FALSE]]
cosSim <- cosineSimilarity(model_cue, model_target)
pairs <- na.omit(data.frame(as.table(cosSim))) %>%
rename(Experimenter_Word=Var1,
Child_Word=Var2,
CosSim=Freq)
d_assoc_sem <- d_assoc_phon %>%
left_join(pairs)
d_assoc_all <- d_assoc_sem
head(d_assoc_all)
View(d_assoc_all)
#We study only associations for which answer is available across development (for Younger, Older and Adults)
#We also eliminate words where children just repeat the cue (e.g., apple -> apple), that with edit distance =0
word_excl <- (d_assoc_all %>%
filter(is.na(Child_Word_phon) | is.na(Child_Word) | Phon_dist =="0") %>%
#filter(is.na(Child_Word_phon) | Phon_dist =="0") %>%
distinct(Experimenter_Word))$Experimenter_Word
##Here average the edit distance
phonDist_all <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(Phon_dist),
sd = sd(Phon_dist),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
phonDist_all$Age2 = factor(phonDist_all$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(phonDist_all, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
##Here narrow down on the small distances
##Histogram
phonDist_small <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2, Phon_dist) %>%
summarise(n0 = n())
##ALL
ggplot(phonDist_small, aes(x=Phon_dist, y=n0))+
geom_col()+
facet_grid(. ~ Age2)
##Only minimal pairs
ggplot(subset(phonDist_small, Phon_dist==1), aes(x=Age2, y=n0))+
geom_col()
head(d_assoc_all)
phonDist_all <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl))
head(phonDist_all)
View(phonDist_all)
d
library(purrr)
library(readr)
library(ggplot2)
library(langcog)
library(boot)
library(dplyr)
library(tidyr)
library(wordbankr)
library(directlabels)
library(stringr)
library(lmtest)
library(rwebppl)
library(jsonlite)
library(nlme)
library(feather)
library(broom)
library(HDInterval)
library(BBmisc)
library(wordVectors)
library(magrittr)
#For each word, list all other the words that have been mentioned
#I should calculate the most frequent response and the percentage from
dict <- read_delim("data/cmu_dict.txt", delim = ",")
d_assoc <- d %>%
dplyr::group_by(Experimenter_Word, partofspeech, ResponseType,  Age2, Child_Word) %>%
dplyr::summarise(n=n()) %>%
dplyr::mutate(percent = 100*n/sum(n)) %>%
dplyr::filter(percent == max(percent))
Exp_words <- d %>%
select(Experimenter_Word) %>%
distinct() %>%
mutate(Word = toupper(Experimenter_Word)) %>%
left_join(dict) %>%
select(-Word) %>%
rename(Experimenter_Word_phon = Phonetic)
Chi_words <- d %>%
select(Child_Word) %>%
distinct() %>%
mutate(Word = toupper(Child_Word)) %>%
left_join(dict) %>%
select(-Word) %>%
rename(Child_Word_phon = Phonetic)
d_assoc_phon <- d_assoc %>%
left_join(Exp_words) %>%
left_join(Chi_words) %>%
rowwise() %>%
mutate(
Exp_code = convert(Experimenter_Word_phon, phon_dict),
Child_code = convert(Child_Word_phon, phon_dict)
) %>%
mutate(Phon_dist = adist(Exp_code, Child_code))
head(d_assoc_phon)
d_assoc_phon <- d %>%
left_join(Exp_words) %>%
left_join(Chi_words) %>%
rowwise() %>%
mutate(
Exp_code = convert(Experimenter_Word_phon, phon_dict),
Child_code = convert(Child_Word_phon, phon_dict)
) %>%
mutate(Phon_dist = adist(Exp_code, Child_code))
head(d_assoc_phon)
d_assoc_ph <- d_assoc_phon %>%
select(ubject, partofspeech, Experimenter_Word, Child_Word, ResponseType, Age, Age2 ,Experimenter_Word_phon, Child_Word_phon, Exp_code, Child_code, Phon_dist )
d_assoc_ph <- d_assoc_phon %>%
select(subject, partofspeech, Experimenter_Word, Child_Word, ResponseType, Age, Age2 ,Experimenter_Word_phon, Child_Word_phon, Exp_code, Child_code, Phon_dist )
head(d_assoc_phon)
d_assoc_ph <- d_assoc_phon %>%
select(Subject, partofspeech, Experimenter_Word, Child_Word, ResponseType, Age, Age2 ,Experimenter_Word_phon, Child_Word_phon, Exp_code, Child_code, Phon_dist )
View(d_assoc_ph)
#Generate the model and store it in "derived"
##Uncomment the following code to re-run the Word2Vec model
#model = train_word2vec("data/corpus.txt",
#                            output="corpus.bin", threads = 4,
#                             vectors = 100, window=20, cbow=1, min_count = 10, force= TRUE)
#Read the model
model = read.vectors("derived/corpus.bin")
Child_words <- (d %>%
distinct(Child_Word))$Child_Word
Experimenter_words <- (d %>%
distinct(Experimenter_Word))$Experimenter_Word
model_cue <- model[[which(rownames(model) %in% Experimenter_words), average=FALSE]]
model_target <- model[[which(rownames(model) %in% Child_words), average=FALSE]]
cosSim <- cosineSimilarity(model_cue, model_target)
pairs <- na.omit(data.frame(as.table(cosSim))) %>%
rename(Experimenter_Word=Var1,
Child_Word=Var2,
CosSim=Freq)
d_assoc_sem <- d_assoc_ph %>%
left_join(pairs)
d_assoc_all <- d_assoc_sem
word_excl <- (d_assoc_all %>%
filter(is.na(Child_Word_phon) | is.na(Child_Word) | Phon_dist =="0") %>%
#filter(is.na(Child_Word_phon) | Phon_dist =="0") %>%
distinct(Experimenter_Word))$Experimenter_Word
##Here average the edit distance
phonDist_all <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(Phon_dist),
sd = sd(Phon_dist),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
phonDist_all$Age2 = factor(phonDist_all$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(phonDist_all, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
head(d_assoc_all)
head(d_assoc_all)
phonDist_all <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl))
head(phonDist_all)
phonDist_all
head(d_assoc_all)
word_excl <- (d_assoc_all %>%
#filter(is.na(Child_Word_phon) | is.na(Child_Word) | Phon_dist =="0") %>%
filter(is.na(Child_Word_phon) | Phon_dist =="0") %>%
distinct(Experimenter_Word))$Experimenter_Word
##Here average the edit distance
phonDist_all <- d_assoc_all %>%
filter(!(Experimenter_Word %in% word_excl))
head(phonDist_all)
head(d_assoc_all)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist =="0") %>%
#filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(Phon_dist),
sd = sd(Phon_dist),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
head(phonDist_all)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist =="0")
head(phonDist_all)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist !="0") %>%
#filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(Phon_dist),
sd = sd(Phon_dist),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
head(phonDist_all)
phonDist_all$Age2 = factor(phonDist_all$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(phonDist_all, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
phonDist_small <- d_assoc_all %>%
#filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2, Phon_dist) %>%
summarise(n0 = n())
ggplot(phonDist_small, aes(x=Phon_dist, y=n0))+
geom_col()+
facet_grid(. ~ Age2)
ggplot(subset(phonDist_small, Phon_dist==1), aes(x=Age2, y=n0))+
geom_col()
ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
geom_smooth(method = "lm")+
#geom_smooth()+
facet_grid(. ~ Age2)
ggplot(d_assoc_all, aes(x=Phon_dist, y=CosSim))+
geom_point()+
geom_smooth(method = "lm")+
#geom_smooth()+
facet_grid(. ~ Age2)
ggplot(d_assoc_all, aes(x=Phon_dist, y=CosSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
phon_sem_dist <- d_assoc_all %>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
group_by(Age2, Phon_dist) %>%
summarise(semDsit = mean(CosSim))
phon_sem_dist <- d_assoc_all %>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
group_by(Age2, Phon_dist) %>%
summarise(semDsit = mean(CosSim))
#ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
ggplot(phon_sem_dist, aes(x=Phon_dist, y=semDsit))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
head(d_assoc_all)
phon_sem_dist <- d_assoc_all %>%
filter(!is.na(CosSim)) %>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
group_by(Age2, Phon_dist) %>%
summarise(semDsit = mean(CosSim))
#ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
ggplot(phon_sem_dist, aes(x=Phon_dist, y=semSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
phon_sem_dist <- d_assoc_all %>%
filter(!is.na(CosSim)) %>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
group_by(Age2, Phon_dist) %>%
summarise(semSim = mean(CosSim))
#ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
ggplot(phon_sem_dist, aes(x=Phon_dist, y=semSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist !=0)
head(phonDist_all)
distinct(phonDist_all, Phon_dist)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != 0) %>%
#filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(Phon_dist),
sd = sd(Phon_dist),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
phonDist_all$Age2 = factor(phonDist_all$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(phonDist_all, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
distinct(phonDist_all, Phon_dist)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != 0)
distinct(phonDist_all, Phon_dist)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != "0")
distinct(phonDist_all, Phon_dist)
phonDist_all <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != 0) %>%
#filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2) %>%
summarise(mean = mean(Phon_dist),
sd = sd(Phon_dist),
n0 = n()) %>%
mutate(se = sd / sqrt(n0),
lower = mean - qt(1 - (0.05 / 2), n0 - 1) * se,
upper = mean + qt(1 - (0.05 / 2), n0 - 1) * se) %>%
select(-sd, -n0, -se)
phonDist_all$Age2 = factor(phonDist_all$Age2, levels = c("Younger", "Older", "Adult"))
ggplot(phonDist_all, aes(x=Age2, y=mean))+
geom_pointrange(aes(ymin = lower, ymax = upper),
position = position_dodge(width = .1))
phonDist_small <- d_assoc_all %>%
#filter(!(Experimenter_Word %in% word_excl)) %>%
group_by(Age2, Phon_dist) %>%
summarise(n0 = n())
ggplot(phonDist_small, aes(x=Phon_dist, y=n0))+
geom_col()+
facet_grid(. ~ Age2)
ggplot(subset(phonDist_small, Phon_dist==1), aes(x=Age2, y=n0))+
geom_col()
phon_sem_dist <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != 0,
!is.na(CosSim)) %>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
group_by(Age2, Phon_dist) %>%
summarise(semSim = mean(CosSim))
#ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
ggplot(phon_sem_dist, aes(x=Phon_dist, y=semSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
##Here show the correlation between phonetinc and semantic distance
phon_sem_dist <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != 0,
!is.na(CosSim)) #%>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
#group_by(Age2, Phon_dist) %>%
#summarise(semSim = mean(CosSim))
#ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
#fit <- lm(CosSim~Phon_dist, data= subset(phon_sem_dist, Age2=='Older'))
#summary(fit)
##Here show the correlation between phonetinc and semantic distance
phon_sem_dist <- d_assoc_all %>%
filter(!is.na(Child_Word_phon),
!is.na(Child_Word),
Phon_dist != 0,
!is.na(CosSim)) #%>%
#  filter(!(Experimenter_Word %in% word_excl)) #%>%
#group_by(Age2, Phon_dist) %>%
#summarise(semSim = mean(CosSim))
ggplot(subset(phon_sem_dist, Phon_dist < 5), aes(x=Phon_dist, y=CosSim))+
#ggplot(phon_sem_dist, aes(x=Phon_dist, y=CosSim))+
geom_point()+
#geom_smooth(method = "lm")+
geom_smooth()+
facet_grid(. ~ Age2)
#fit <- lm(CosSim~Phon_dist, data= subset(phon_sem_dist, Age2=='Older'))
#summary(fit)
